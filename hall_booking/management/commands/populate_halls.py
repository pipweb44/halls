from django.core.management.base import BaseCommand
from django.core.files.base import ContentFile
from hall_booking.models import Category, Hall
import random
from datetime import datetime

class Command(BaseCommand):
    help = 'إضافة 100 قاعة تجريبية في مختلف محافظات مصر'

    def handle(self, *args, **options):
        # إنشاء فئات القاعات
        categories_data = [
            {
                'name': 'قاعات مؤتمرات',
                'description': 'قاعات مجهزة للمؤتمرات والندوات',
                'icon': 'fas fa-microphone'
            },
            {
                'name': 'قاعات حفلات',
                'description': 'قاعات مناسبة للحفلات والمناسبات',
                'icon': 'fas fa-birthday-cake'
            },
            {
                'name': 'قاعات اجتماعات',
                'description': 'قاعات صغيرة للاجتماعات والتدريب',
                'icon': 'fas fa-users'
            },
            {
                'name': 'قاعات أفراح',
                'description': 'قاعات فاخرة لحفلات الأفراح',
                'icon': 'fas fa-heart'
            },
            {
                'name': 'قاعات معارض',
                'description': 'قاعات واسعة للمعارض والفعاليات',
                'icon': 'fas fa-store'
            }
        ]

        # إنشاء الفئات
        categories = []
        for cat_data in categories_data:
            category, created = Category.objects.get_or_create(
                name=cat_data['name'],
                defaults={
                    'description': cat_data['description'],
                    'icon': cat_data['icon']
                }
            )
            categories.append(category)
            if created:
                self.stdout.write(f'تم إنشاء فئة: {category.name}')

        # بيانات محافظات مصر
        governorates = [
            {'name': 'القاهرة', 'areas': ['وسط البلد', 'المعادي', 'مدينة نصر', 'الزمالك', 'مصر الجديدة', 'المرج']},
            {'name': 'الإسكندرية', 'areas': ['سموحة', 'سيدي جابر', 'المنتزه', 'العجمي', 'ميامي', 'ستانلي']},
            {'name': 'الجيزة', 'areas': ['الدقي', 'المهندسين', '6 أكتوبر', 'الشيخ زايد', 'الهرم', 'بولاق الدكرور']},
            {'name': 'الشرقية', 'areas': ['الزقازيق', 'العاشر من رمضان', 'بلبيس', 'أبو كبير', 'فاقوس', 'ههيا']},
            {'name': 'الغربية', 'areas': ['طنطا', 'المحلة الكبرى', 'زفتى', 'سمنود', 'قطور', 'بسيون']},
            {'name': 'كفر الشيخ', 'areas': ['كفر الشيخ', 'دسوق', 'فوه', 'مطوبس', 'سيدي سالم', 'الرياض']},
            {'name': 'المنوفية', 'areas': ['شبين الكوم', 'سادات', 'أشمون', 'الباجور', 'قويسنا', 'بركة السبع']},
            {'name': 'المنيا', 'areas': ['المنيا', 'مطاي', 'بني مزار', 'مغاغة', 'سمالوط', 'أبو قرقاص']},
            {'name': 'أسيوط', 'areas': ['أسيوط', 'ديروط', 'منفلوط', 'أبنوب', 'البداري', 'ساحل سليم']},
            {'name': 'سوهاج', 'areas': ['سوهاج', 'أخميم', 'البلينا', 'مرسى', 'الغنايم', 'طهطا']},
            {'name': 'قنا', 'areas': ['قنا', 'قوص', 'نقادة', 'دشنا', 'أبو تشت', 'فرشوط']},
            {'name': 'الأقصر', 'areas': ['الأقصر', 'إسنا', 'الطود', 'بياضة العرب', 'الزينية', 'القرنة']},
            {'name': 'أسوان', 'areas': ['أسوان', 'كوم أمبو', 'دراو', 'نصر النوبة', 'كلابشة', 'إدفو']},
            {'name': 'بني سويف', 'areas': ['بني سويف', 'الواسطي', 'ناصر', 'إهناسيا', 'ببا', 'سمسطا']},
            {'name': 'الفيوم', 'areas': ['الفيوم', 'سنورس', 'طامية', 'إطسا', 'يوسف الصديق', 'إبشواي']},
            {'name': 'دمياط', 'areas': ['دمياط', 'فارسكور', 'الزرقا', 'كفر البطيخ', 'الروضة', 'السرو']},
            {'name': 'الدقهلية', 'areas': ['المنصورة', 'ميت غمر', 'أجا', 'السنبلاوين', 'بني عبيد', 'المنزلة']},
            {'name': 'البحيرة', 'areas': ['دمنهور', 'كفر الدوار', 'رشيد', 'إدكو', 'أبو المطامير', 'حوش عيسى']},
            {'name': 'الإسماعيلية', 'areas': ['الإسماعيلية', 'فايد', 'القنطرة شرق', 'القنطرة غرب', 'التل الكبير', 'أبو صوير']},
            {'name': 'بورسعيد', 'areas': ['بورسعيد', 'بورفؤاد', 'العرب', 'الزهور', 'المناخ', 'الضواحي']},
            {'name': 'شمال سيناء', 'areas': ['العريش', 'رفح', 'بئر العبد', 'نخل', 'الحسنة', 'الشيخ زويد']},
            {'name': 'جنوب سيناء', 'areas': ['الطور', 'سانت كاترين', 'دهب', 'نويبع', 'شرم الشيخ', 'طابا']},
            {'name': 'البحر الأحمر', 'areas': ['الغردقة', 'رأس غارب', 'سفاجا', 'القصير', 'مرسى علم', 'برنيس']},
            {'name': 'الوادي الجديد', 'areas': ['الخارجة', 'الداخلة', 'الفرافرة', 'باريس', 'موط', 'بلاط']},
            {'name': 'مطروح', 'areas': ['مرسى مطروح', 'سيدي براني', 'السلوم', 'سيوة', 'النجيلة', 'راس الحكمة']}
        ]

        # أسماء القاعات
        hall_names = [
            'قاعة النور', 'قاعة الأمل', 'قاعة المستقبل', 'قاعة النجوم', 'قاعة الأفق',
            'قاعة الإبداع', 'قاعة التميز', 'قاعة الإنجاز', 'قاعة النجاح', 'قاعة التقدم',
            'قاعة الابتكار', 'قاعة التطور', 'قاعة الرقي', 'قاعة التفوق', 'قاعة الإتقان',
            'قاعة الجودة', 'قاعة الخبرة', 'قاعة الاحترافية', 'قاعة التميز', 'قاعة الإنجاز',
            'قاعة النجاح', 'قاعة التقدم', 'قاعة الابتكار', 'قاعة التطور', 'قاعة الرقي',
            'قاعة التفوق', 'قاعة الإتقان', 'قاعة الجودة', 'قاعة الخبرة', 'قاعة الاحترافية',
            'قاعة الأصالة', 'قاعة التراث', 'قاعة الحضارة', 'قاعة الثقافة', 'قاعة الفنون',
            'قاعة الأدب', 'قاعة العلم', 'قاعة المعرفة', 'قاعة الحكمة', 'قاعة البصيرة',
            'قاعة الرؤية', 'قاعة الطموح', 'قاعة الطموح', 'قاعة الطموح', 'قاعة الطموح',
            'قاعة الطموح', 'قاعة الطموح', 'قاعة الطموح', 'قاعة الطموح', 'قاعة الطموح'
        ]

        # مميزات القاعات
        features_list = [
            ['مكيف هواء', 'إضاءة متطورة', 'نظام صوت'],
            ['شاشة عرض', 'واي فاي مجاني', 'مقاعد مريحة'],
            ['مطبخ مجهز', 'موقف سيارات', 'خدمة تنظيف'],
            ['مصعد', 'مكيف مركزي', 'نظام أمان'],
            ['مطبخ تجاري', 'موقف سيارات كبير', 'خدمة كاملة'],
            ['شاشة LED', 'نظام صوت احترافي', 'إضاءة مسرحية'],
            ['مطبخ مجهز بالكامل', 'موقف سيارات', 'خدمة تنظيف'],
            ['مصعد', 'مكيف مركزي', 'نظام أمان متطور'],
            ['مطبخ تجاري', 'موقف سيارات كبير', 'خدمة كاملة'],
            ['شاشة LED كبيرة', 'نظام صوت احترافي', 'إضاءة مسرحية']
        ]

        # إنشاء 100 قاعة
        halls_created = 0
        for i in range(100):
            # اختيار محافظة ومنطقة عشوائية
            governorate = random.choice(governorates)
            area = random.choice(governorate['areas'])
            
            # اختيار فئة عشوائية
            category = random.choice(categories)
            
            # اختيار اسم عشوائي
            hall_name = random.choice(hall_names)
            
            # إنشاء اسم فريد
            unique_name = f"{hall_name} - {area}"
            
            # تحديد السعة والسعر بناءً على الفئة
            if category.name == 'قاعات مؤتمرات':
                capacity = random.randint(50, 500)
                price_per_hour = random.randint(200, 800)
            elif category.name == 'قاعات حفلات':
                capacity = random.randint(30, 200)
                price_per_hour = random.randint(150, 600)
            elif category.name == 'قاعات اجتماعات':
                capacity = random.randint(10, 50)
                price_per_hour = random.randint(100, 400)
            elif category.name == 'قاعات أفراح':
                capacity = random.randint(100, 800)
                price_per_hour = random.randint(300, 1200)
            else:  # قاعات معارض
                capacity = random.randint(200, 1000)
                price_per_hour = random.randint(250, 900)

            # إنشاء وصف للقاعة
            description = f"قاعة {hall_name} في {area} - {governorate['name']}. قاعة مجهزة بالكامل تناسب جميع أنواع المناسبات والفعاليات. تتميز بموقع مميز وخدمة عالية الجودة."

            # اختيار مميزات عشوائية
            features = random.choice(features_list)

            # إنشاء القاعة
            hall = Hall.objects.create(
                name=unique_name,
                category=category,
                description=description,
                capacity=capacity,
                price_per_hour=price_per_hour,
                status='available',
                features=features
            )
            
            halls_created += 1
            if halls_created % 10 == 0:
                self.stdout.write(f'تم إنشاء {halls_created} قاعة...')

        self.stdout.write(
            self.style.SUCCESS(f'تم إنشاء {halls_created} قاعة بنجاح في مختلف محافظات مصر!')
        ) 